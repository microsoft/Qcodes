Add a do2d_retrace function